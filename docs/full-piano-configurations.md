# 全钢琴配置套餐文档

## 概述

基于原有的28键4行7列钢琴配置，我们新增了多种钢琴配置套餐，以满足不同场景和用户需求，从精简的移动端配置到完整的专业钢琴配置。

## 钢琴配置套餐

### 1. 标准钢琴 (28键) - 推荐
**配置ID**: `piano-30-keys`
- **布局**: 4行7列
- **特点**: 每行一个完整的do到si音阶
- **音域**: C2到B5 (4个八度)
- **适用场景**: 音乐教学、音阶练习、基础演奏

#### 音阶分布
```
行1: C2  D2  E2  F2  G2  A2  B2
行2: C3  D3  E3  F3  G3  A3  B3  
行3: C4  D4  E4  F4  G4  A4  B4  ← 包含中央C4
行4: C5  D5  E5  F5  G5  A5  B5
```

### 2. 全钢琴键盘 (60键) - 专业版
**配置ID**: `full-piano-60-keys`
- **布局**: 5行12列
- **特点**: 包含所有半音，完整钢琴音域
- **音域**: C1到B5 (5个八度)
- **适用场景**: 专业演奏、作曲编曲、完整音乐创作

#### 音阶分布
```
行1: C1  C#1 D1  D#1 E1  F1  F#1 G1  G#1 A1  A#1 B1
行2: C2  C#2 D2  D#2 E2  F2  F#2 G2  G#2 A2  A#2 B2
行3: C3  C#3 D3  D#3 E3  F3  F#3 G3  G#3 A3  A#3 B3
行4: C4  C#4 D4  D#4 E4  F4  F#4 G4  G#4 A4  A#4 B4  ← 包含中央C4和标准A4
行5: C5  C#5 D5  D#5 E5  F5  F#5 G5  G#5 A5  A#5 B5
```

#### 颜色编码
- **金色**: 中央C4 (参考点)
- **红色**: 标准A4 (440Hz)
- **蓝色**: 白键 (自然音)
- **紫色**: 黑键 (半音)

### 3. 精简钢琴 (21键) - 移动版
**配置ID**: `compact-piano-21-keys`
- **布局**: 3行7列
- **特点**: 每行一个完整的do到si音阶，适合小屏幕
- **音域**: C3到B5 (3个八度)
- **适用场景**: 移动端演奏、简单旋律创作

#### 音阶分布
```
行1: C3  D3  E3  F3  G3  A3  B3
行2: C4  D4  E4  F4  G4  A4  B4  ← 包含中央C4
行3: C5  D5  E5  F5  G5  A5  B5
```

## 技术实现细节

### 频率计算方法

#### 28键标准钢琴
```javascript
// 基于C2 = 65.406 Hz
const c2Frequency = 65.406;
const semitoneSteps = [0, 2, 4, 5, 7, 9, 11]; // 自然音半音步数
const frequency = c2Frequency * Math.pow(2, semitonesFromC2 / 12);
```

#### 60键全钢琴
```javascript
// 基于C1 = 32.703 Hz
const c1Frequency = 32.703;
const semitonesFromC1 = (octave - 1) * 12 + col; // 包含所有半音
const frequency = c1Frequency * Math.pow(2, semitonesFromC1 / 12);
```

#### 21键精简钢琴
```javascript
// 基于C3 = 130.81 Hz
const c3Frequency = 130.81;
const semitoneSteps = [0, 2, 4, 5, 7, 9, 11]; // 标准自然音半音步数
const frequency = c3Frequency * Math.pow(2, semitonesFromC3 / 12);
```

## 配置选择指南

### 音乐教学场景
- **推荐**: 28键标准钢琴
- **理由**: 符合音乐理论，每行一个完整音阶，便于教学

### 专业演奏场景
- **推荐**: 60键全钢琴
- **理由**: 包含所有半音，支持复杂和弦和旋律

### 移动端使用
- **推荐**: 21键精简钢琴
- **理由**: 布局紧凑，适合触摸操作，每行一个完整音阶

### 初学者练习
- **推荐**: 28键标准钢琴
- **理由**: 音域适中，布局直观，学习曲线平缓

## 网格布局优化

### 自动布局调整
配置页面会根据选择的钢琴预设自动建议最优网格布局：

| 预设 | 推荐布局 | 总格子数 | 使用率 |
|------|----------|----------|--------|
| 28键标准 | 4行7列 | 28 | 100% |
| 60键全钢琴 | 5行12列 | 60 | 100% |
| 21键精简 | 3行7列 | 21 | 100% |

### 布局特点
- **无浪费**: 所有格子都有对应音符
- **视觉直观**: 行列对应音乐结构
- **操作便利**: 横向音高变化，纵向八度变化

## 使用建议

### 配置切换
1. 进入配置页面的"音效库预设"
2. 选择合适的钢琴配置
3. 系统会自动调整网格布局
4. 确认应用预设

### 个性化调整
- 可以单独调整每个音符的音量
- 支持修改音色(正弦波、方波等)
- 可以自定义颜色和图标
- 支持启用/禁用特定音符

### 性能考虑
- 60键配置对设备性能要求较高
- 移动端建议使用21键或28键配置
- 可以根据网络状况选择合适的配置

## 更新记录

- **v1.0**: 添加28键标准钢琴配置
- **v1.1**: 新增60键全钢琴和21键精简配置
- **v1.2**: 优化颜色编码和布局算法

## 多点触控支持 🎵

所有钢琴配置现已完全支持多点触控，带来更丰富的演奏体验：

### 演奏增强
- **和弦演奏**: 同时按下多个音符演奏和弦
- **分手演奏**: 左右手分别负责不同音域
- **多重节奏**: 多个手指创造复杂节奏模式
- **实时合奏**: 多人同时在一个设备上演奏

### 配置推荐
- **21键精简**: 最适合多点触控，格子较大便于精确操作
- **28键标准**: 平衡的选择，支持基本和弦演奏
- **60键全钢琴**: 专业级演奏，支持复杂和声

### 技术特性
- **智能防重复**: 同一触摸点在同一格子不会重复触发
- **实时追踪**: 每个触摸点独立追踪，避免音效混乱
- **视觉指示**: 活动触摸点实时显示，便于观察演奏状态

详细信息请参考：[多点触控支持文档](./multitouch-support.md)

## 后续计划

- [ ] 添加爵士钢琴配置(包含蓝调音阶)
- [ ] 支持自定义音律(非十二平均律)
- [ ] 添加钢琴踏板效果模拟
- [ ] 支持录制和回放功能
- [ ] 多点触控手势识别
- [ ] 触摸压力感应支持 
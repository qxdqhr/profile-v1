# Mikutap 动画功能使用指南

## 概述

Mikutap现在支持丰富的动画效果！每个音效格子都可以配置独特的动画，在点击触发音效时播放精美的视觉效果。

## 动画类型

### 1. 内置动画类型

- **脉冲效果 (pulse)** - 放大缩小效果，经典的脉冲动画
- **滑动效果 (slide)** - 方块从指定方向滑过
- **弹跳效果 (bounce)** - 上下弹跳的活泼动画
- **闪烁效果 (flash)** - 快速闪烁吸引注意
- **旋转效果 (spin)** - 360度旋转动画
- **缩放效果 (scale)** - 渐变缩放效果
- **涟漪效果 (ripple)** - 水波扩散效果
- **爆炸效果 (explosion)** - 快速扩张的爆炸动画
- **漩涡效果 (vortex)** - 旋转缩放的漩涡动画
- **闪电效果 (lightning)** - 快速闪烁的闪电动画
- **彩虹效果 (rainbow)** - 颜色渐变的彩虹动画
- **波浪效果 (wave)** - 多重扩散的波浪动画

### 2. 自定义Lottie动画

支持使用Lottie JSON格式的自定义动画，可以创建复杂的矢量动画效果。

## 配置方法

### 在配置页面设置

1. 打开 Mikutap 配置管理页面
2. 点击要编辑的音效格子
3. 在弹出的编辑界面中找到"🎨 动画配置"部分
4. 配置以下选项：
   - **启用动画**: 是否启用点击动画效果
   - **动画类型**: 选择动画类型
   - **持续时间**: 动画播放时长(100-2000ms)
   - **缩放倍数**: 动画的缩放倍数(0.5-3.0)
   - **透明度**: 动画覆盖层的透明度(0.1-1.0)
   - **动画方向**: 对于滑动动画，选择滑动方向

### 自定义Lottie动画

1. 选择动画类型为"自定义动画 - Lottie JSON"
2. 在文本框中粘贴Lottie JSON数据
3. 动画数据可以从以下来源获取：
   - [LottieFiles](https://lottiefiles.com/) - 免费的Lottie动画库
   - After Effects + Bodymovin插件导出
   - 自行编写JSON动画数据

## 示例动画JSON

项目提供了一些示例动画JSON文件，位于：
```
public/mikutap/animations/animations.json
```

包含以下示例：
- `pulse`: 脉冲动画
- `sparkle`: 闪烁星星动画
- `wave`: 波浪扩散动画
- `explosion`: 爆炸效果动画
- `vortex`: 漩涡效果动画
- `lightning`: 闪电效果动画
- `rainbow`: 彩虹效果动画

## 最佳实践

### 1. 动画性能
- 建议持续时间控制在300-800ms之间
- 避免过于复杂的Lottie动画以保证性能
- 移动端建议使用较简单的动画

### 2. 视觉协调
- 为不同音色类型设置不同的动画风格
- 考虑动画与音效的同步感
- 保持整体视觉风格的一致性

### 3. 用户体验
- 动画应该增强而不是干扰音乐体验
- 在帮助蒙层显示时自动禁用动画避免干扰
- 提供动画开关选项

## 技术实现

### 动画触发时机
- 仅在帮助蒙层隐藏时触发动画
- 键盘和鼠标/触摸操作都会触发对应的动画
- 动画与音效播放同步进行

### 数据存储
- 动画配置存储在数据库中，支持跨设备同步
- 包含以下字段：
  - `animationEnabled`: 是否启用动画
  - `animationType`: 动画类型
  - `animationData`: Lottie JSON数据（可选）
  - `animationConfig`: 动画参数配置

### 组件架构
- `GridCellAnimation`: 核心动画组件
- 支持CSS动画和Lottie动画两种渲染方式
- 响应式设计，适配桌面和移动端

## 故障排除

### 常见问题

**Q: 动画不播放？**
A: 检查是否启用了动画，确认帮助蒙层已关闭

**Q: Lottie动画显示异常？**
A: 检查JSON格式是否正确，尝试从LottieFiles下载标准格式

**Q: 动画影响性能？**
A: 减少动画持续时间，使用简化的动画类型

**Q: 移动端动画卡顿？**
A: 使用CSS动画代替复杂的Lottie动画

## 更新日志

### v1.2.0 (当前版本)
- ✨ 新增8种内置动画类型
- ✨ 支持自定义Lottie JSON动画
- ✨ 完整的动画配置界面
- ✨ 数据库持久化存储
- ✨ 响应式动画设计
- 🐛 修复键盘映射可选化问题

---

享受您的音乐动画体验吧！🎵✨ 
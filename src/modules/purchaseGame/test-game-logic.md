# 购买游戏逻辑测试

## 测试场景：生命值为0时游戏结束

### 测试步骤
1. 启动游戏，初始生命值为3，源石锭为100
2. 购买一个价值为3的害命商品
3. 验证游戏是否立即结束

### 预期结果
- 购买后生命值变为0
- 游戏状态变为FINISHED
- 显示结算弹窗
- 控制台输出"Game ended due to life reaching 0"

### 测试场景：生命值刚好等于商品价值
1. 当前生命值为2
2. 出现价值为2的害命商品
3. 提示信息显示"⚠️ 点击购买将消耗 2 生命值，游戏将结束！"
4. 购买后游戏结束

### 测试场景：生命值大于商品价值
1. 当前生命值为3
2. 出现价值为1的害命商品
3. 提示信息显示"点击购买将消耗 1 生命值"
4. 购买后生命值变为2，游戏继续

## 修改内容

### 1. 游戏服务逻辑优化
- 修改了`purchaseProduct`方法中的游戏结束检查逻辑
- 添加了更详细的注释和日志输出
- 确保生命值不会显示负数

### 2. 配置服务逻辑优化
- 修改了`canPurchaseProduct`方法
- 允许购买生命值刚好等于商品价值的商品
- 从`currentLife > product.value`改为`currentLife >= product.value`

### 3. 用户界面优化
- 在`GameControlsProps`中添加了`currentLife`参数
- 当生命值刚好等于商品价值时，显示警告提示
- 提示信息包含"⚠️"图标和"游戏将结束！"警告

## 验证方法

访问以下页面进行测试：
- 主游戏页面：http://localhost:3005/purchaseGame
- 测试页面：http://localhost:3005/test-purchase-game

## 测试要点

1. **边界条件测试**：生命值刚好等于商品价值的情况
2. **用户体验测试**：警告提示是否清晰明确
3. **游戏流程测试**：游戏结束逻辑是否正确执行
4. **状态管理测试**：游戏状态转换是否正确 